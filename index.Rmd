---
title: "HPGC Fourball Match Play 2017"
output: html_document
---

```{r echo=FALSE}
library(knitr)
library(pander)
```



Last updated: `r format(Sys.time(),"%b %d, %Y %H:%M")`

##Table of Contents  

2.  [Pool Play](#pp)  
3.  [Tournament Format](#format)  
4.  [Roster (including current handicaps)](#roster)  
5.  [2016 tournament](final2016.html)
  



```{r echo=FALSE}
pooler <- read.csv("poolPlay.csv", stringsAsFactors = FALSE)


names(pooler) = c("Team","Pool","Player 1","Player 2","Wins","Losses","Ties","Points","Holes Won")

assign_win <- function(in_frame, teamid) {
    out_vect <- in_frame[teamid,]
    out_vect["Wins"] <- out_vect["Wins"] + 1
    out_vect["Points"] <- out_vect["Points"] + 3
    out_vect
}

assign_loss <- function(in_frame, teamid) {
    out_vect <- in_frame[teamid,]
    out_vect["Losses"] <- out_vect["Losses"] + 1
    out_vect
}

assign_tie <- function(in_frame, teamid) {
    out_vect <- in_frame[teamid,]
    out_vect["Ties"] <- out_vect["Ties"] + 1
    out_vect["Points"] <- out_vect["Points"] + 1
    out_vect
}

giveRes <- function(in_frame, team1_id, team2_id, team1_points, team2_points) {
    ret_frame <- in_frame
    ret_frame[team1_id, "Holes Won"] <- ret_frame[team1_id, "Holes Won"] + team1_points
    ret_frame[team2_id, "Holes Won"] <- ret_frame[team2_id, "Holes Won"] + team2_points
    if (team1_points > team2_points) {
        ret_frame[team1_id,] <- assign_win(ret_frame, team1_id)
        ret_frame[team2_id,] <- assign_loss(ret_frame, team2_id)
    } else if (team2_points > team1_points) {
        ret_frame[team1_id,] <- assign_loss(ret_frame, team1_id)
        ret_frame[team2_id,] <- assign_win(ret_frame, team2_id)
    } else {
        ret_frame[team1_id,] <- assign_tie(ret_frame, team1_id)
        ret_frame[team2_id,] <- assign_tie(ret_frame, team2_id)
    }
    ret_frame
}

doPander <- function(group, complete = FALSE) {
    # create the pander table for groups, announcing winners if complete
    q <- pooler[pooler$Pool==group,-2]
    row.names(q) <- NULL
    if (complete) {
        emphasize.strong.rows(1)
        emphasize.italics.rows(1)
        myCaption <- sprintf("%s and %s win Group %s!",q$`Player 1`[1], q$`Player 2`[1], group)
    } else {
        myCaption <- NULL
    }
    
    pander(q,row.names=FALSE, style = "simple", split.table = 240, caption = myCaption)
}

pullLast <- function(nm) {
    strsplit(nm," ")[[1]][2]
}

doPanderWC <- function(winners, complete = FALSE) {
    # create the pander table for groups, announcing winners if complete
    q <- pooler[!(pooler$Team %in% winners),-2]
    row.names(q) <- NULL
    if (complete) {
        emphasize.italics.rows(1:3)
        lNames <- sapply(c(q[1,2], q[1,3], q[2,2], q[2,3], q[3,2], q[3,3]), pullLast)
        names(lNames) <- NULL
        myCaption <- sprintf("%s/%s, %s/%s, and %s/%s advance!", 
                             lNames[1], lNames[2], lNames[3], lNames[4], lNames[5], lNames[6])
    } else {
        myCaption <- NULL
    }
    pander(q,row.names=FALSE, style = "simple", split.table = 240, caption = myCaption)
}

findWinners <- function(group) {
    # find the winners for each group
    q <- pooler[pooler$Pool==group,]
    q$Team[1]
}

# Kahn/Lee def. Harrington/De Silva, 11.5 - 6.5 (5 and 4)

pooler <- giveRes(pooler, 16, 9, 11.5, 6.5)

# Cook/Sokitch halved with Solomon/Simpson, 9 - 9 (AS)

pooler <- giveRes(pooler, 1, 13, 9, 9)

#* 6/10 - Momota/Goodman def. Schneider/Drish, 9.5 - 8.5 (2 and 1)

pooler <- giveRes(pooler, 22, 15, 9.5, 8.5)

# * 6/15 - Bonsall/Betts def. Schneider/Drish, 9.5 - 8.5 (1 up)  

pooler <- giveRes(pooler, 4, 15, 9.5, 8.5)

# * 6/17 - Bonsall/Betts def. Momota/Goodman, 12 - 6 (7 and 5)  

pooler <- giveRes(pooler, 4, 22, 12, 6)

# * 6/23 - Ota/Yeh halved with Brennan/Henderson, 9 - 9 (AS)  

pooler <- giveRes(pooler, 20, 10, 9, 9)

# * 7/2 - Cook/Sokitch def. Pettersson/Beauduy, 10-8 (1 up) 

pooler <- giveRes(pooler, 1, 12, 10, 8)

#* 7/8 - Scroggins/Bernick def. Hubregsen/Sodergren, 9.5 - 8.5 (1 up)

pooler <- giveRes(pooler, 14, 7, 9.5, 8.5)

# * 7/23 - Dhadal/Tao def. Costello/Daly, 10.5 - 7.5 (3 and 2)  

pooler <- giveRes(pooler, 3, 6, 10.5, 7.5)

# * 7/26 - Atkinson/Molke def. Ota/Yeh, 11 - 7 (4 and 3)  

pooler <- giveRes(pooler, 17, 20, 11, 7)

# * 7/29 - Harrington/De Silva def. Pettersson/Beauduy, 10 - 8 (2 up)  

pooler <- giveRes(pooler, 9, 12, 10, 8)

# * 7/30 - Dhadal/Tao def. Hubregsen/Sodergren, 11 - 7 (4 and 3)  

pooler <- giveRes(pooler, 3, 7, 11, 7)

# * 7/31 - Atkinson/Mole def. Brennan/Henderson, 9.5 - 8.5 (1 up)  

pooler <- giveRes(pooler, 17, 10, 9.5, 8.5)

# * 8/2 - Ota/Yeh def. Bartz/Bartz, 10 - 8 (3 and 2)  

pooler <- giveRes(pooler, 20, 18, 10, 8)

# * 8/5 - Ota/Yeh def. Brenninger/Ippolito, 10 - 8 (3 and 2)  

pooler <- giveRes(pooler, 20, 25, 10, 8)

#* 8/5 - Beatty/Schroeder def. Selmi/Mellinger, 9.5 - 8.5 (1 up)

pooler <- giveRes(pooler, 8, 2, 9.5, 8.5)

# * 8/6 - Costello/Daly def. Hubregsen/Sodergren, 11.5 - 6.5 (5 and 3)  

pooler <- giveRes(pooler, 6, 7, 11.5, 6.5)

# * 8/6 - Dhadal/Tao def. Scroggins/Bernick, 10.5 - 7.5 (4 and 3)  

pooler <- giveRes(pooler, 3, 14, 10.5, 7.5)

# * 8/19 - Scroggins/Bernick halved with Costello/Daly, 9 - 9 (AS)  

pooler <- giveRes(pooler, 14, 6, 9, 9)

# * 8/20 - Schroeder/Beatty halved with Clifford/Shirbroun, 9 - 9 (AS)  

pooler <- giveRes(pooler, 8, 11, 9, 9)

# * 8/26 - Harrington/De Silfa def. Cook/Sokitch, 10.5 - 7.5 (3 and 2)  

pooler <- giveRes(pooler, 9, 1, 10.5, 7.5)

# * 8/26 - Scroggins/Bernick def. Beer/Debruyn, 11 - 7 (4 and 3)  

pooler <- giveRes(pooler, 14, 21, 11, 7)  

# * 9/2 - Rovetti/Welbeloved def. Clifford/Shirbroun, 10 - 8 (4 and 3) 

pooler <- giveRes(pooler, 24, 11, 10, 8)  

#* 9/3 - Harrington/De Silva def. Solomon/Simpson, 10 - 8 (2 and 1)  

pooler <- giveRes(pooler, 9, 13, 10, 8)  

# * 9/8 - Bonsall/Betts def. Russell/Zywicke, 10.5 - 7.5 (3 and 2)  

pooler <- giveRes(pooler, 4, 19, 10.5, 7.5)

# * 9/14 - Mellinger/Selmi def. Moore/Vines, 9.5 - 8.5 (1 up)  

pooler <- giveRes(pooler, 2, 23, 9.5, 8.5)

# * 9/17 - Markman/Notaney def. Bonsall/Betts, 11.5 - 6.5 (4 and 3)  

pooler <- giveRes(pooler, 5, 4, 11.5, 6.5)

# * 9/17 - Ippolito/Breininger def. Brennan/Henderson, 13.5 - 4.5 (6 and 4)  

pooler <- giveRes(pooler, 25, 10, 13.5, 4.5)

# * 9/21 - Russell/Zywicke def. Markman/Notaney, 10 - 8 (2 up)  

pooler <- giveRes(pooler, 19, 5, 10, 8)

## Now sort the standings
pooler <- pooler[order(pooler[,"Points"], pooler[, "Holes Won"], pooler[, "Team"], decreasing = TRUE),]



winners <- sapply(c("A","B","C","D","E"), findWinners)

pOffs <- pooler[pooler$Team %in% winners,]
pOffs <- rbind(pOffs, pooler[!(pooler$Team %in% winners), ][1:3,])
pOffs[,2] <- 1:8
names(pOffs)[2] <- "Seed"
pOffs$Method <- "Wild Card"
pOffs$Method[1:5] <- "Won Group"

seeds <- paste(pOffs[,3],pOffs[,4], sep = "/")


```



```{r echo=FALSE, results="asis", eval = FALSE}
q <- pOffs[,c("Seed", "Player 1", "Player 2", "Method")]
row.names(q) <- NULL
pander(q,row.names=FALSE, style = "simple", split.table = 240)

```  





##Pool Play  
<a id="pp"></a>  

###Pool Results  

* 5/27 - Kahn/Lee def. Harrington/De Silva, 11.5 - 6.5 (5 and 4)  
* 5/28 - Cook/Sokitch halved with Solomon/Simpson, 9 - 9 (AS)  
* 6/10 - Momota/Goodman def. Schneider/Drish, 9.5 - 8.5 (2 and 1)
* 6/15 - Bonsall/Betts def. Schneider/Drish, 9.5 - 8.5 (1 up)  
* 6/17 - Bonsall/Betts def. Momota/Goodman, 12 - 6 (7 and 5)  
* 6/23 - Ota/Yeh halved with Brennan/Henderson, 9 - 9 (AS)  
* 7/2 - Cook/Sokitch def. Pettersson/Beauduy, 10 - 8 (1 up)  
* 7/8 - Scroggins/Bernick def. Hubregsen/Sodergren, 9.5 - 8.5 (1 up)  
* 7/23 - Dhadal/Tao def. Costello/Daly, 10.5 - 7.5 (3 and 2)  
* 7/26 - Atkinson/Molke def. Ota/Yeh, 11 - 7 (4 and 3)  
* 7/29 - Harrington/De Silva def. Pettersson/Beauduy, 10 - 8 (2 up)  
* 7/30 - Dhadal/Tao def. Hubregsen/Sodergren, 11 - 7 (4 and 3)  
* 7/31 - Atkinson/Mole def. Brennan/Henderson, 9.5 - 8.5 (1 up)
* 8/2 - Ota/Yeh def. Bartz/Bartz, 10 - 8 (3 and 2)  
* 8/5 - Ota/Yeh def. Brenninger/Ippolito, 10 - 8 (3 and 2)  
* 8/5 - Schroeder/Beatty def. Mellinger/Selmi, 9.5 - 8.5 (1 up)  
* 8/6 - Costello/Daly def. Hubregsen/Sodergren, 11.5 - 6.5 (5 and 3)  
* 8/6 - Dhadal/Tao def. Scroggins/Bernick, 10.5 - 7.5 (4 and 3)  
* 8/19 - Scroggins/Bernick halved with Costello/Daly, 9 - 9 (AS)  
* 8/20 - Schroeder/Beatty halved with Clifford/Shirbroun, 9 - 9 (AS)  
* 8/26 - Harrington/De Silva def. Cook/Sokitch, 10.5 - 7.5 (3 and 2)  
* 8/26 - Scroggins/Bernick def. Beer/Debruyn, 11 - 7 (4 and 3)  
* 9/2 - Rovetti/Wellbeloved def. Clifford/Shirbroun, 10 - 8 (4 and 3) 
* 9/3 - Harrington/De Silva def. Solomon/Simpson, 10 - 8 (2 and 1)  
* 9/8 - Bonsall/Betts def. Russell/Zywicke, 10.5 - 7.5 (3 and 2)  
* 9/14 - Mellinger/Selmi def. Moore/Vines, 9.5 - 8.5 (1 up)  
* 9/17 - Markman/Notaney def. Bonsall/Betts, 11.5 - 6.5 (4 and 3)  
* 9/17 - Ippolito/Breininger def. Brennan/Henderson, 13.5 - 4.5 (6 and 4)  
* 9/21 - Russell/Zywicke def. Markman/Notaney, 10 - 8 (2 up)  








###Group A  
```{r echo=FALSE, results="asis"}


doPander("A", FALSE)
```  


###Group B  
```{r echo=FALSE, results="asis"}

doPander("B", FALSE)
``` 


###Group C  
```{r echo=FALSE, results="asis"}

doPander("C", FALSE)
``` 

###Group D  
```{r echo=FALSE, results="asis"}

doPander("D", FALSE)
``` 

###Group E  
```{r echo=FALSE, results="asis"}

doPander("E", FALSE)
```  



```{r echo = FALSE, results = "asis", eval=FALSE}



doPanderWC(winners, FALSE)
```

##Tournament Format, Rules, and Schedule  
<a id="format"></a>  

###Match Format  
This tournament is standard fourball match play--teams of two play against eachother in match play.  Both team members play their own ball, with the lower (net) score of the partners being the team's score for that hole.  If teams tie on a hole the hole is halved, there are no carry-overs  

###Location  
Pool play matches can occur at any course, provided both sides agree.  All playoff matches will be played at TPC Harding Park  

###Tees  
All matches at TPC Harding Park will be played from the white tees.  Matches at other courses will be played from whatever tees both sides can agree upon  

###Handicaps  
All matches will be played net.  We will follow the USGA method for assigning handicaps for net fourball play--the lowest course handicap in the foursome will play off scratch, with each of the remaining players playing to the difference between their course handicap and the lowest.  For example, if the four players have course handicaps of 4, 7, 7, and 8, the 4 handicap will get 0 strokes, the two 7's will get strokes on handicap holes 1 - 3, and the 8 handicap will get strokes on handicap holes 1 - 4.  

The handicaps in play for each match will be the course handicaps based on full GHIN indexes as of the date of the match.  For transparency, indices for all players will be updated bi-weekly with the GHIN updates on this site in the roster section [here](#roster).  Note that the Course Handicap calculation is for TPC Harding Park only, course handicaps will need to be handled by the teams themselves for matches conducted at other courses.

###Rules  
USGA rules of golf and the [HPGC local tournament rules](http://www.golffusion.com/hardingparkgolf/content/1576305/Local-Tournament-Rules) will govern all play.  For matches conducted at other courses, the Local Rules for All Competitions section of the [HPGC local tournament rules](http://www.golffusion.com/hardingparkgolf/content/1576305/Local-Tournament-Rules) will apply, along with any posted local rules at the course being utilized

###Schedule  
Pool play will take place from May through the end of September, with playoffs to begin in October.  All matches, including the playoffs, will be self-scheduled, and players are reponsible for their own greens fees.  Early weekend times are always difficult at TPC Harding Park, so I recommend booking early as cancellation is free

###Pool Play  
Teams have been grouped into five pools of five.  The first part of the tournament is round robin pool play--each team will play each otehr team in their pool once.  

During pool play, matches will continue for all 18 holes, regardless of who wins.  Each hole won will be worth one point for the winning team, while halved holes will be worth a half point for both teams.  The team with the most holes won wins regardless, but total holes won will be important for breaking ties in the likely event that teams have the same record  

In the event that a team needs to concede / forfeit a match, the team conceded to will count the win.  To protect the rest of the field, they will earn 9.5 "total holes won", and the concedign team will earn 0.

###Posting Scores  
Players are responsible for posting their own scores for handicap purposes; The Committee will not be doing so.  As a reminder, for handicap purposes, holes where players do not finish out (either because of a concession or because they cannot better their opponent) should be recorded as the score that the player most likely would have made on that hole, subject to ESC.

###Order of finish  
Final standings within the pool will be based on:  

1.  Win/Loss record:  Wins are worth 3 points, ties are worth 1  
2.  If tied on #1, total holes won
2.  If tied on #2, head-to-head record  

###Playoffs  
Twelve teams will make the playoffs, the five pool winners plus seven wildcard teams based on (1) pool play match record or (2) total holes won during pool play.  The four highest seeds will receive a bye in the first round.

Playoffs will be single elimination play.  In the event of a match being all square after 18 holes, extra holes will be played on flemming, according th the following, per TPC Harding Park:  

*  Playoff sudden death will only be permitted on Fleming, regardless of the activity on Harding  
*  Golfers will need to check into the golf shop after the 18th hole and advise of the playoff sudden death  
*  Players will have to wait their turn on Fleming 1  
*  Players will have to exit the course once the match is determined  

Hole handicaps on Fleming are based on 9 hole matches, not 18.  So, for extra hole purposes, the handicap index will be $2 * n - 1$, where $n$ is the index listed on the Fleming score card.  Effectively, this follows the convention of all odd-indexed holes being on the front 9.   

###Prizes

TBD

##Roster  
<a id="roster"></a>
```{r echo=FALSE}

ch <- function(idx) {
    isNH <- idx=="NH"
    isPlus <- (substr(idx,1,1)=="+")
    rating <- 124
    hin <- numeric(length(idx))
    hin[!isNH] <- as.numeric(idx[!isNH])
    chi <- character(length(idx))
    chi[!isNH] <- as.character(round(rating/113*hin[!isNH],0))
    chi[isPlus&&chi!="0"] <- paste("+",chi[isPlus])
    chi[isNH] <- "0"
    chi
    
}

roster <- read.csv("../rosterPools.csv")
index <- read.csv("../indexResults.csv", colClasses = c("numeric","character","character"))
roster <- merge(roster, index, by.x="ghin",by.y="ghin")
roster$index[roster$ghin==9999999] <- "NH"

roster <- roster[,c("Name","teamNo","pools","index","asOf")]

roster$'Course Handicap' <- ch(roster$index)
names(roster) <- c("Player","Team","Pool","Handicap Index","Current As Of", "Course Handicap")
roster <- roster[order(roster$Team),]
pander(roster,row.names=FALSE, style = "simple", split.table = 240)
```
